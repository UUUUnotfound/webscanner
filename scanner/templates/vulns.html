{% extends "base.html" %}


{% block title %}
vulns
{% endblock %}


{% block content %}
<script type='text/javascript'>
function myfunc(){
    alert('only test');
}

// myfunc();
</script>

<div class="container">
    <div class="row">
        <div class="panel panel-success">
            <div class="panel-heading">
                <h3 class="panel-title text-center">domain-ip-info</h3>
            </div>
            <div class="panel-body">
                <table class="table table-striped table-bordered table-hover table-condensed">
                    <thead>
                        <tr>
                            <th>id</th>
                            <th>url</th>
                            <th>parameters</th>
                            <th>method</th>
                            <th>vuln_name</th>
                            <th>severity</th>
                            <th>id_domain</th>
                            <th>action1 </th>
                            <th>action2 </th>
                        </tr>
                    </thead>
                    <tbody>

                    {% for obj in ipobjs.object_list %}
                    <tr class="vuln-id-{{obj.id}}">
                        <td> <p id='objid'>{{obj.id}} </p> </td>
                        <td><a href="{{obj.url}}" target="_blank">{{obj.url}}</a></td>
                        <td> {{obj.parameters}}</td>
                        <td> {{obj.method}}</td>
                        <td> {{obj.vuln_name}}</td>
                        <td> {{obj.severity}}</td>
                        <td> {{obj.id_domain}}</td>
                        <td> <button id="delete-btn" class="btn btn-primary" onclick="optdelete({{obj.id}})"> delete </button> </td>
                        <!--<td><a href="/deleteopt?id={{obj.id}}&table=vulns">delete</a></td> -->
                        <td><a href="/scandevice/showceleryresult?celery_taskid={{task.celery_taskid}}">show celery result</a></td>
                    </tr>
                    {% endfor %}

                    </tbody>
                </table>


            </div>
        </div>


    <div class="panel panel-default">
        <div class="panel-body">
        <ul class="pager">
            {% if ipobjs.has_previous %}
              <li class="previous"> <a href="?page={{ ipobjs.previous_page_number }}">Previous</a></li>
            {% else %}
            <li class="previous disabled"><a href="#">&larr; Older</a></li>
            {% endif %}


              Page {{ ipobjs.number }} of {{ ipobjs.paginator.num_pages }}.

            {% if ipobjs.has_next %}
             <li class="next"> <a href="?page={{ ipobjs.next_page_number }}">Next</a> </li>
            {% endif %}
        </ul>
        </div>
    </div>


       

    </div>
</div>


<script type='text/javascript'>
    function optdelete(str){
            var c = confirm('do u want really delete item ' + str);
            if (c==false){
                return;
            }
            $.ajax({
                url: '/deleteopt',
                dataType: 'json',
                data: {table: 'vulns', id: str },
                type: 'GET',
                success: function(data, textStatus, XMLHttpRequest){
                    //alert('ok');
                    $('.vuln-id-'+str).css('display', 'none');
                    // alert('set done');
                    },
                error: function(XMLHttpRequest, textStatus, errorThrown){
                    alert('not ok by e' );
                    },
                });
        }
</script>

<!--     <a href="/scandevice/create"> go to create one task </a><br>
    <br>
    <a href="/scandevice/showstatus">showstatus</a>
 -->
{% endblock %}






